<!DOCTYPE html>
<html lang="pt-br">

<head>
  <meta charset="utf-8">

  <title>Agência M3 - Agência de Performance Digital</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0, shrink-to-fit=no">

  <link rel="stylesheet" type="text/css" href="./main.css">

  
  <script src="https://code.jquery.com/jquery-3.6.0.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script>
</head>


<body>
  <div class="content">

    <header>

      <section class="header-container">
        <a href="index.html">
          <img src="img/logo-m3.png" alt="M3 Performance Digital">
        </a>
        
        <div class="bag">
          <button type="button" id="bag-btn">
            <img src="img/bag.png" alt="bag">
            <span id="bag-count-info"></span>
          </button>

          <div class="bag-container">
            <div class="bag-list">
              <div class="bag-item">
               
              </div>
            </div>
             <div class="bag-total">
               <h3>Total: R$</h3>
               <span id="bag-total-value"></span>
             </div>
          </div>
        </div>
      </section>

    </header>
    
    <div class="title">
      <h1>Blusas</h1>
    </div>


     <section class="dropdown-container">

      <button class="btn-responsive" onclick="initOrderNav()">
        Ordenar
      </button>

      <div class="dropdown">
        
        <button class="dropdowbtn">Ordenar por:</button>
        <div class="title-filter-mobile">
          <h2>ordenar</h2>
          <button class="close-bnt" onclick="closeOrderNav()">X</button>
        </div>
        <div class="dropdown-content">
          <button onClick="orderByTime()"><input type="checkbox" class="all-filter" id="byTime" name="byTime"><label for="byTime">Mais recentes</label></button>
          <button onClick="orderByLowerPrice()"><input type="checkbox" class="all-filter" id="byLprice" name="byLowPrice"><label for="byLprice">Menor preço</label></button>
          <button onClick="orderByHigherPrice()"><input type="checkbox" class="all-filter" id="byHprice" name="byHighPrice"><label for="byHprice">Maior preço</label></button>
        </div>
        
      </div>
    </section>
    


    <section class="nav">

      <button class="btn-responsive" onclick="initFilterNav()">
        Filtrar
      </button>
    
      <dl class="side-nav js-side-nav">
        
        <div class="title-filter-mobile">
          <h2>Filtrar</h2>
          <button class="close-bnt" onclick="closeFilterNav()">X</button>
        </div>

        <dt>Cores</dt>
        <dd>
          <ul id="input-cores">
            <li><a onclick="filterSelectionColor('Amarelo')"><input type="radio" id="Amarelo" name="color"><label for="amarelo" >Amarelo</label></a></li>

            <li><a onclick="filterSelectionColor('Azul')"><input type="radio" id="Azul" name="color" ><label for="azul">Azul</label></a></li>

            <li><a onclick="filterSelectionColor('Branco')"><input type="radio" id="Branco" name="color" class="checkboxAlternate"><label for="branco" >Branco</label></a></li>

            <li><a onclick="filterSelectionColor('Cinza')"><input type="radio" id="Cinza" name="color" class="checkboxAlternate"><label for="cinza">Cinza</label></ali>

            <li><a onclick="filterSelectionColor('Laranja')"><input type="radio" id="Laranja" name="color" class="checkboxAlternate"><label for="laranja">Laranja</label></li>
          </ul>
          <a class="active-filter button-filter" onClick="filterSelectionColor('all')"><input type="radio" class="all-filter" id="all-cores" name="color"><label for="all-cores">Ver todas as cores</label></a>
        </dd>
        
        <dt>Tamanhos</dt>
        <dd>
          <ul class="tamanhos">
            <li><a onClick="filterSelectionSize('P')">P</a></li>
            <li><a onClick="filterSelectionSize('M')">M</a></li>
            <li><a onClick="filterSelectionSize('G')">G</a></li>
            <li><a onClick="filterSelectionSize('GG')">GG</a></li>
            <li><a onClick="filterSelectionSize('U')">U</a></li>
            <li><a onClick="filterSelectionSize('36')">36</a></li>
            <li><a onClick="filterSelectionSize('38')">38</a></li>
            <li><a onClick="filterSelectionSize('40')">40</a></li>
            <li><a onClick="filterSelectionSize('42')">42</a></li>
            <li><a onClick="filterSelectionSize('44')">44</a></li>
            <li><a onClick="filterSelectionSize('46')">46</a></li>
          </ul>

        </dd>
        
        <dt>Faixa de preço</dt>
        <dd>
          <ul id="input-price">
            <li><a onClick="filterSelectionPrice('0')"><input type="radio" id="0" name="price"><label for="0">de R$0 até R$50</label></a></li>
            <li><a onClick="filterSelectionPrice('51')"><input type="radio" id="51" name="price"><label for="51">de R$51 até R$150</label></a></li>
            <li><a onClick="filterSelectionPrice('151')"><input type="radio" id="151" name="price"><label for="151">de R$151 até R$300</label></a></li>
            <li><a onClick="filterSelectionPrice('301')"><input type="radio" id="301" name="price"><label for="301">de R$301 até R$500</label></a></li>
            <li><a onClick="filterSelectionPrice('all')"><input type="radio" id="all" name="price"><label for="all" >a partir de R$ 01</label></a></li>
          </ul> 
        </dd>

        
        <div class="btn-responsive-filter">
          <button class="btn-responsive-apply">Aplicar</button>
          <button class="btn-responsive-remove" onClick="filterSelectionClean('all');removeSizeStyle()"><input type="radio" id="clean" name="clean" class="all-filter"><label for="clean">Limpar</label></button>
        </div>
     </dl>

    </section>
      
      <section class="product">
      
        <div class="product-list">
         
        </div>
        
        <button id="loadMore" class="carregar-mais">Carregar Mais</button>
    </section>

    
    <footer class="footer">
      <p>Agência M3 - Agência de Performance Digital</p>
    </footer>

    <script src="./bundle.js"></script>

    <!-- JAVASCRIPT INDEX -->

      <script type="text/javascript">

  function filterSelectionColor(e) {
      var x, i;
      x = document.getElementsByClassName("product-vitrine");
      if (e == "all") e = "";

      for (i = 0; i < x.length; i++) {

        removeFilter(x[i], "hideColor");
        removeFilter(x[i], "showByColor");
        if (x[i].className.indexOf(e) == -1 && e !== "") addFilter(x[i], "hideColor");
        if (x[i].className.indexOf(e) > -1) addFilter(x[i], "showByColor");
      } 
    }
    
    function filterSelectionSize(e) {
      var x, i;
      x = document.getElementsByClassName("product-vitrine");
      if (e == "all") e = "";

      for (i = 0; i < x.length; i++) {
        removeFilter(x[i], "hideSize");
        removeFilter(x[i], "showBySize");
        if (x[i].className.indexOf(e) == -1 && e !== "") addFilter(x[i], "hideSize");
        
        
        if (x[i].className.indexOf(e) > -1) addFilter(x[i], "showBySize");
      } 
    }

    function filterSelectionPrice(e) {
      var x, i;
      x = document.getElementsByClassName("product-vitrine");
      if (e == "all") e = "";

      for (i = 0; i < x.length; i++) {
        removeFilter(x[i], "hidePrice");
        removeFilter(x[i], "showByPrice");
        if (x[i].className.indexOf(e) == -1 && e !== "") addFilter(x[i], "hidePrice");
        
        
        if (x[i].className.indexOf(e) > -1) addFilter(x[i], "showByPrice");
      
      } 
    }

    function filterSelectionClean(e) {
      var x, i;
      x = document.getElementsByClassName("product-vitrine");
      if (e == "all") e = "";

      for (i = 0; i < x.length; i++) {
        removeFilter(x[i], "hidePrice");
        removeFilter(x[i], "showByPrice");
        removeFilter(x[i], "hideSize");
        removeFilter(x[i], "showBySize");
        removeFilter(x[i], "hideColor");
        removeFilter(x[i], "showByColor");
      } 
    }

    function addFilter(element, name) {
      var i, arr1, arr2;
      arr1 = element.className.split(" ");
      arr2 = name.split(" ");
      for (i = 0; i < arr2.length; i++) {
        if (arr1.indexOf(arr2[i]) == -1) {
          element.className += " " + arr2[i];
        }
      }
    }

    function removeFilter(element, name) {
      var i, arr1, arr2;
      arr1 = element.className.split(" ");
      arr2 = name.split(" ");
      for (i = 0; i < arr2.length; i++) {
        while (arr1.indexOf(arr2[i]) > -1) {
          arr1.splice(arr1.indexOf(arr2[i]), 1);
        }
      }
      element.className = arr1.join(" ");
    }

  //Input de Tamanhos <style>

  function checkSizeStyle() {

  const elementosTamanhos = document.querySelectorAll(".tamanhos li a");

  function activeSize(item) {
    elementosTamanhos.forEach((e) => {
      e.classList.remove('checkSize');
    });
    elementosTamanhos[item].classList.add('checkSize');
  }

    elementosTamanhos.forEach((item, e) => {
      item.addEventListener('click', () => {
        activeSize(e)
      })
    })
  } checkSizeStyle();


  function removeSizeStyle() {


  const elementosTamanhos = document.querySelectorAll(".tamanhos li a");

  function activeSize(item) {
    elementosTamanhos.forEach((e) => {
      e.classList.remove('checkSize');
    });
    elementosTamanhos[item].classList.remove('checkSize');
  }

  var color = document.getElementsByName("color");
    for(var i=0;i<color.length;i++)
        color[i].checked = false;


  var price = document.getElementsByName("price");
    for(var i=0;i<price.length;i++)
        price[i].checked = false;

    activeSize()
  }

  //Filter responsivo


  function initFilterContent() {

    const filterTitulos = document.querySelectorAll('.js-side-nav dt')

    const appearClass = 'appear';
    
    if(filterTitulos.length) {
      
      function appearInfo() {
        this.classList.toggle(appearClass);
        this.nextElementSibling.classList.toggle(appearClass)
      }
      
      filterTitulos.forEach((item) =>{
        item.addEventListener('click', appearInfo)
      })
    } 
  } initFilterContent();

  function initFilterNav() {
      var element = document.querySelector(".side-nav");
      element.classList.add("appear");
    } 

  function closeFilterNav() {
    var element = document.querySelector(".side-nav");
    element.classList.remove("appear");
  }

  </script>

  <!-- JAVASCRIPT ORDENATE -->

  <script type="text/javascript">
  function orderByLowerPrice() {
      fetch('http://localhost:5000/products')
      .then(response => response.json())
      .then(function (data) {
        data.sort(function(a, b) {
          return parseFloat(a.price.replace(",", ".")) - parseFloat(b.price.replace(",", "."));
        })
    
        let html = '';
        data.forEach(product => {
          html += `
            <div class="product-vitrine ${product.color} ${product.size} ${product.price}">
              <img src="${product.image}" alt="imagem do produto">
              <h3>${product.name}</h3>
              <span>R$ ${product.price}</span>
              <p>${product.parcelamento}</p>
              <button class="add-to-bag-btn">Comprar</button>
            </div>
          `;
        });
        productList.innerHTML = html;
      });
    }
    
    function orderByHigherPrice() {
      fetch('http://localhost:5000/products')
      .then(response => response.json())
      .then(function (data) {
        data.sort(function(a, b) {
          return parseFloat(b.price.replace(",", ".")) - parseFloat(a.price.replace(",", "."));
        })
    
        let html = '';
        data.forEach(product => {
          html += `
            <div class="product-vitrine ${product.color} ${product.size} ${product.price}">
              <img src="${product.imgSrc}" alt="imagem do produto">
              <h3>${product.name}</h3>
              <span>R$ ${product.price}</span>
              <p>${product.parcelamento}</p>
              <button class="add-to-bag-btn">Comprar</button>
            </div>
          `;
        });
        productList.innerHTML = html;
      });
    }
    
    function orderByTime() {
      fetch('http://localhost:5000/products')
      .then(response => response.json())
      .then(function (data) {
        data.sort(function(a, b) {
          return a.createdAt - b.createdAt;
        })
    
        let html = '';
        data.forEach(product => {
          html += `
            <div class="product-vitrine ${product.color} ${product.size} ${product.price}">
              <img src="${product.imgSrc}" alt="imagem do produto">
              <h3>${product.name}</h3>
              <span>R$ ${product.price}</span>
              <p>${product.parcelamento}</p>
              <button class="add-to-bag-btn">Comprar</button>
            </div>
          `;
        });
        productList.innerHTML = html;
      });
    }
    
    //Ordenar responsivo
    
    function initOrderNav() {
      var element = document.querySelector(".dropdown");
      element.classList.add("appear");
    }
    
    function closeOrderNav() {
    var element = document.querySelector(".dropdown");
    element.classList.remove("appear");
    }
  </script>



  </div>
  </body>
  </html>